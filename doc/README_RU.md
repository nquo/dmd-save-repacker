# Death Must Die save repacker

[also in English](../README.md)

С помощью этой утилиты можно распаковывать и запаковывать сохранения из игры.

Неплохой способ чтобы сохранить время на гринд и потратить его на что-нибудь полезное
(например на изучение языка rust)

# Как пользоваться
У программы есть только один аргумент для запуска - это имя входного файла.
Запускаете с файлом у которого расширение .sav - получаете распакованый json.
Наоборот, запускаете с json - получаете запакованый sav.

В целях безопасности, чтобы не затереть оригинальный свой прогресс, приложение
не может перезаписывать файлы, только создает новые если имя уже занято.

## Распаковка .sav в формат .json
`dmdsave Slot_0.sav`

## Упаковка .json обратно в .sav
`dmdsave result_00.json`

## Пути к файлу сохранения
Игра написана на Unity так что пути к сохранению у нее стандартные:

| OS      | path                                                                              |
|---------|-----------------------------------------------------------------------------------|
| MacOS   | `~/Library/Application Support/com.Realm-Archive.Death-Must-Die/Saves/Slot_0.sav` |
| Windows | `\Appdata\LocalLow\Realm Archive\Death Must Die\Saves\Slot_0.sav.`                |                

## Процесс работы
1. Ищем файл `Slot_0.sav` в своей операционной системе
2. Делаем его бэкап на всякий случай
3. Распаковываем его командой `dmdsave Slot_0.sav` и получаем на выходе `result_00.json` файл
4. Вносим изменения в `.json` файл в любимом текстовом редакторе.
5. Упаковываем назад командйjq `dmdsave result_00.json`, получаем файл с именем в стиле `result_00.sav`
6. Переименовываем в `Slot_0.sav` и ручками кладем в папку с ориганалом, заменяя его

## Что можно такого сделать в файле сохранения?
### Добавить золота
Самая безобидная модификация которая не испортит впечатления от игры.
Открываем `result_*.json` и поиском ищем строку `Gold`. Найдется результат в стиле вот этого:
```json
\"Gold\":400}
```
Просто исправляем количество своего золота на желаемое.

### Изменять вещи
У каждой найденной вещи есть список [Аффиксов-свойств](Affixes.md) который можно изменить. После того как Вы
нашли шмотку в json файле, в json массиве Affixes [], поменяйте или добавьте новый json объект из двух
полей `{Code:?, Level:?}`. Например:
#### Быстрая перезарядка прыжков
```json
{\\\"Code\\\":\\\"dcld%\\\",\\\"Levels\\\":10}
```
Этот аффикс ускоряет на 100% время перезарядки прыжков. Думаю что это идеальное свойство для любых тапочек.

#### Свойство призыва армии и скелетов
```json
{\\\"Code\\\":\\\"ssum4\\\",\\\"Levels\\\":100}
```
Так как тут 100й уровень, то призывается аж 400 скелетов чтобы биться за Вас.

#### Радиус сбора кристаллов опыта
```json
{\\\"Code\\\":\\\"pul\\\",\\\"Levels\\\":200}
```
Площать сбора увеличивается на +6000

#### Как найти вещь в файле сохранения?
Найти надетую на персонажа вещь моно по фразе `BoundToCharacterCode`.

Найти вещь по ее типу можно по фразе `\\\"Type\\\"`. Список типов:

| Type     | Position |
|----------|----------|
| Оружие   | 0        |
| Шапка    | 1        |
| Торс     | 2        |
| Руки     | 3        |
| Пояс     | 4        |
| Обувь    | 5        |
| Кольцо   | 6        |
| Амулет   | 7        |
| Реликвия | 8        |
| Ювелирка | 9        |

Отлично поиграть и повеселиться!
(тестировалось на игре версии v0.7.1)